{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst {\n  ConcatSource,\n  OriginalSource\n} = require(\"webpack-sources\");\n\nconst Template = require(\"./Template\");\n/** @typedef {import(\"../declarations/WebpackOptions\").LibraryCustomUmdObject} LibraryCustomUmdObject */\n\n/** @typedef {import(\"./Compilation\")} Compilation */\n\n/**\n * @param {string[]} accessor the accessor to convert to path\n * @returns {string} the path\n */\n\n\nconst accessorToObjectAccess = accessor => {\n  return accessor.map(a => `[${JSON.stringify(a)}]`).join(\"\");\n};\n/**\n * @param {string=} base the path prefix\n * @param {string|string[]} accessor the accessor\n * @param {string=} joinWith the element separator\n * @returns {string} the path\n */\n\n\nconst accessorAccess = (base, accessor, joinWith = \", \") => {\n  const accessors = Array.isArray(accessor) ? accessor : [accessor];\n  return accessors.map((_, idx) => {\n    const a = base ? base + accessorToObjectAccess(accessors.slice(0, idx + 1)) : accessors[0] + accessorToObjectAccess(accessors.slice(1, idx + 1));\n    if (idx === accessors.length - 1) return a;\n    if (idx === 0 && base === undefined) return `${a} = typeof ${a} === \"object\" ? ${a} : {}`;\n    return `${a} = ${a} || {}`;\n  }).join(joinWith);\n};\n/** @typedef {string | string[] | LibraryCustomUmdObject} UmdMainTemplatePluginName */\n\n/**\n * @typedef {Object} AuxiliaryCommentObject\n * @property {string} root\n * @property {string} commonjs\n * @property {string} commonjs2\n * @property {string} amd\n */\n\n/**\n * @typedef {Object} UmdMainTemplatePluginOption\n * @property {boolean=} optionalAmdExternalAsGlobal\n * @property {boolean} namedDefine\n * @property {string | AuxiliaryCommentObject} auxiliaryComment\n */\n\n\nclass UmdMainTemplatePlugin {\n  /**\n   * @param {UmdMainTemplatePluginName} name the name of the UMD library\n   * @param {UmdMainTemplatePluginOption} options the plugin option\n   */\n  constructor(name, options) {\n    if (typeof name === \"object\" && !Array.isArray(name)) {\n      this.name = name.root || name.amd || name.commonjs;\n      this.names = name;\n    } else {\n      this.name = name;\n      this.names = {\n        commonjs: name,\n        root: name,\n        amd: name\n      };\n    }\n\n    this.optionalAmdExternalAsGlobal = options.optionalAmdExternalAsGlobal;\n    this.namedDefine = options.namedDefine;\n    this.auxiliaryComment = options.auxiliaryComment;\n  }\n  /**\n   * @param {Compilation} compilation the compilation instance\n   * @returns {void}\n   */\n\n\n  apply(compilation) {\n    const {\n      mainTemplate,\n      chunkTemplate,\n      runtimeTemplate\n    } = compilation;\n\n    const onRenderWithEntry = (source, chunk, hash) => {\n      let externals = chunk.getModules().filter(m => m.external && (m.externalType === \"umd\" || m.externalType === \"umd2\"));\n      const optionalExternals = [];\n      let requiredExternals = [];\n\n      if (this.optionalAmdExternalAsGlobal) {\n        for (const m of externals) {\n          if (m.optional) {\n            optionalExternals.push(m);\n          } else {\n            requiredExternals.push(m);\n          }\n        }\n\n        externals = requiredExternals.concat(optionalExternals);\n      } else {\n        requiredExternals = externals;\n      }\n\n      const replaceKeys = str => {\n        return mainTemplate.getAssetPath(str, {\n          hash,\n          chunk\n        });\n      };\n\n      const externalsDepsArray = modules => {\n        return `[${replaceKeys(modules.map(m => JSON.stringify(typeof m.request === \"object\" ? m.request.amd : m.request)).join(\", \"))}]`;\n      };\n\n      const externalsRootArray = modules => {\n        return replaceKeys(modules.map(m => {\n          let request = m.request;\n          if (typeof request === \"object\") request = request.root;\n          return `root${accessorToObjectAccess([].concat(request))}`;\n        }).join(\", \"));\n      };\n\n      const externalsRequireArray = type => {\n        return replaceKeys(externals.map(m => {\n          let expr;\n          let request = m.request;\n\n          if (typeof request === \"object\") {\n            request = request[type];\n          }\n\n          if (request === undefined) {\n            throw new Error(\"Missing external configuration for type:\" + type);\n          }\n\n          if (Array.isArray(request)) {\n            expr = `require(${JSON.stringify(request[0])})${accessorToObjectAccess(request.slice(1))}`;\n          } else {\n            expr = `require(${JSON.stringify(request)})`;\n          }\n\n          if (m.optional) {\n            expr = `(function webpackLoadOptionalExternalModule() { try { return ${expr}; } catch(e) {} }())`;\n          }\n\n          return expr;\n        }).join(\", \"));\n      };\n\n      const externalsArguments = modules => {\n        return modules.map(m => `__WEBPACK_EXTERNAL_MODULE_${Template.toIdentifier(`${m.id}`)}__`).join(\", \");\n      };\n\n      const libraryName = library => {\n        return JSON.stringify(replaceKeys([].concat(library).pop()));\n      };\n\n      let amdFactory;\n\n      if (optionalExternals.length > 0) {\n        const wrapperArguments = externalsArguments(requiredExternals);\n        const factoryArguments = requiredExternals.length > 0 ? externalsArguments(requiredExternals) + \", \" + externalsRootArray(optionalExternals) : externalsRootArray(optionalExternals);\n        amdFactory = `function webpackLoadOptionalExternalModuleAmd(${wrapperArguments}) {\\n` + `\t\t\treturn factory(${factoryArguments});\\n` + \"\t\t}\";\n      } else {\n        amdFactory = \"factory\";\n      }\n\n      const auxiliaryComment = this.auxiliaryComment;\n\n      const getAuxilaryComment = type => {\n        if (auxiliaryComment) {\n          if (typeof auxiliaryComment === \"string\") return \"\\t//\" + auxiliaryComment + \"\\n\";\n          if (auxiliaryComment[type]) return \"\\t//\" + auxiliaryComment[type] + \"\\n\";\n        }\n\n        return \"\";\n      };\n\n      return new ConcatSource(new OriginalSource(\"(function webpackUniversalModuleDefinition(root, factory) {\\n\" + getAuxilaryComment(\"commonjs2\") + \"\tif(typeof exports === 'object' && typeof module === 'object')\\n\" + \"\t\tmodule.exports = factory(\" + externalsRequireArray(\"commonjs2\") + \");\\n\" + getAuxilaryComment(\"amd\") + \"\telse if(typeof define === 'function' && define.amd)\\n\" + (requiredExternals.length > 0 ? this.names.amd && this.namedDefine === true ? \"\t\tdefine(\" + libraryName(this.names.amd) + \", \" + externalsDepsArray(requiredExternals) + \", \" + amdFactory + \");\\n\" : \"\t\tdefine(\" + externalsDepsArray(requiredExternals) + \", \" + amdFactory + \");\\n\" : this.names.amd && this.namedDefine === true ? \"\t\tdefine(\" + libraryName(this.names.amd) + \", [], \" + amdFactory + \");\\n\" : \"\t\tdefine([], \" + amdFactory + \");\\n\") + (this.names.root || this.names.commonjs ? getAuxilaryComment(\"commonjs\") + \"\telse if(typeof exports === 'object')\\n\" + \"\t\texports[\" + libraryName(this.names.commonjs || this.names.root) + \"] = factory(\" + externalsRequireArray(\"commonjs\") + \");\\n\" + getAuxilaryComment(\"root\") + \"\telse\\n\" + \"\t\t\" + replaceKeys(accessorAccess(\"root\", this.names.root || this.names.commonjs)) + \" = factory(\" + externalsRootArray(externals) + \");\\n\" : \"\telse {\\n\" + (externals.length > 0 ? \"\t\tvar a = typeof exports === 'object' ? factory(\" + externalsRequireArray(\"commonjs\") + \") : factory(\" + externalsRootArray(externals) + \");\\n\" : \"\t\tvar a = factory();\\n\") + \"\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\\n\" + \"\t}\\n\") + `})(${runtimeTemplate.outputOptions.globalObject}, function(${externalsArguments(externals)}) {\\nreturn `, \"webpack/universalModuleDefinition\"), source, \";\\n})\");\n    };\n\n    for (const template of [mainTemplate, chunkTemplate]) {\n      template.hooks.renderWithEntry.tap(\"UmdMainTemplatePlugin\", onRenderWithEntry);\n    }\n\n    mainTemplate.hooks.globalHashPaths.tap(\"UmdMainTemplatePlugin\", paths => {\n      if (this.names.root) paths = paths.concat(this.names.root);\n      if (this.names.amd) paths = paths.concat(this.names.amd);\n      if (this.names.commonjs) paths = paths.concat(this.names.commonjs);\n      return paths;\n    });\n    mainTemplate.hooks.hash.tap(\"UmdMainTemplatePlugin\", hash => {\n      hash.update(\"umd\");\n      hash.update(`${this.names.root}`);\n      hash.update(`${this.names.amd}`);\n      hash.update(`${this.names.commonjs}`);\n    });\n  }\n\n}\n\nmodule.exports = UmdMainTemplatePlugin;","map":{"version":3,"sources":["/Users/hamzakhan/Documents/twitter-react/twitter/node_modules/webpack/lib/UmdMainTemplatePlugin.js"],"names":["ConcatSource","OriginalSource","require","Template","accessorToObjectAccess","accessor","map","a","JSON","stringify","join","accessorAccess","base","joinWith","accessors","Array","isArray","_","idx","slice","length","undefined","UmdMainTemplatePlugin","constructor","name","options","root","amd","commonjs","names","optionalAmdExternalAsGlobal","namedDefine","auxiliaryComment","apply","compilation","mainTemplate","chunkTemplate","runtimeTemplate","onRenderWithEntry","source","chunk","hash","externals","getModules","filter","m","external","externalType","optionalExternals","requiredExternals","optional","push","concat","replaceKeys","str","getAssetPath","externalsDepsArray","modules","request","externalsRootArray","externalsRequireArray","type","expr","Error","externalsArguments","toIdentifier","id","libraryName","library","pop","amdFactory","wrapperArguments","factoryArguments","getAuxilaryComment","outputOptions","globalObject","template","hooks","renderWithEntry","tap","globalHashPaths","paths","update","module","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst { ConcatSource, OriginalSource } = require(\"webpack-sources\");\nconst Template = require(\"./Template\");\n\n/** @typedef {import(\"../declarations/WebpackOptions\").LibraryCustomUmdObject} LibraryCustomUmdObject */\n/** @typedef {import(\"./Compilation\")} Compilation */\n\n/**\n * @param {string[]} accessor the accessor to convert to path\n * @returns {string} the path\n */\nconst accessorToObjectAccess = accessor => {\n\treturn accessor.map(a => `[${JSON.stringify(a)}]`).join(\"\");\n};\n\n/**\n * @param {string=} base the path prefix\n * @param {string|string[]} accessor the accessor\n * @param {string=} joinWith the element separator\n * @returns {string} the path\n */\nconst accessorAccess = (base, accessor, joinWith = \", \") => {\n\tconst accessors = Array.isArray(accessor) ? accessor : [accessor];\n\treturn accessors\n\t\t.map((_, idx) => {\n\t\t\tconst a = base\n\t\t\t\t? base + accessorToObjectAccess(accessors.slice(0, idx + 1))\n\t\t\t\t: accessors[0] + accessorToObjectAccess(accessors.slice(1, idx + 1));\n\t\t\tif (idx === accessors.length - 1) return a;\n\t\t\tif (idx === 0 && base === undefined)\n\t\t\t\treturn `${a} = typeof ${a} === \"object\" ? ${a} : {}`;\n\t\t\treturn `${a} = ${a} || {}`;\n\t\t})\n\t\t.join(joinWith);\n};\n\n/** @typedef {string | string[] | LibraryCustomUmdObject} UmdMainTemplatePluginName */\n\n/**\n * @typedef {Object} AuxiliaryCommentObject\n * @property {string} root\n * @property {string} commonjs\n * @property {string} commonjs2\n * @property {string} amd\n */\n\n/**\n * @typedef {Object} UmdMainTemplatePluginOption\n * @property {boolean=} optionalAmdExternalAsGlobal\n * @property {boolean} namedDefine\n * @property {string | AuxiliaryCommentObject} auxiliaryComment\n */\n\nclass UmdMainTemplatePlugin {\n\t/**\n\t * @param {UmdMainTemplatePluginName} name the name of the UMD library\n\t * @param {UmdMainTemplatePluginOption} options the plugin option\n\t */\n\tconstructor(name, options) {\n\t\tif (typeof name === \"object\" && !Array.isArray(name)) {\n\t\t\tthis.name = name.root || name.amd || name.commonjs;\n\t\t\tthis.names = name;\n\t\t} else {\n\t\t\tthis.name = name;\n\t\t\tthis.names = {\n\t\t\t\tcommonjs: name,\n\t\t\t\troot: name,\n\t\t\t\tamd: name\n\t\t\t};\n\t\t}\n\t\tthis.optionalAmdExternalAsGlobal = options.optionalAmdExternalAsGlobal;\n\t\tthis.namedDefine = options.namedDefine;\n\t\tthis.auxiliaryComment = options.auxiliaryComment;\n\t}\n\n\t/**\n\t * @param {Compilation} compilation the compilation instance\n\t * @returns {void}\n\t */\n\tapply(compilation) {\n\t\tconst { mainTemplate, chunkTemplate, runtimeTemplate } = compilation;\n\n\t\tconst onRenderWithEntry = (source, chunk, hash) => {\n\t\t\tlet externals = chunk\n\t\t\t\t.getModules()\n\t\t\t\t.filter(\n\t\t\t\t\tm =>\n\t\t\t\t\t\tm.external &&\n\t\t\t\t\t\t(m.externalType === \"umd\" || m.externalType === \"umd2\")\n\t\t\t\t);\n\t\t\tconst optionalExternals = [];\n\t\t\tlet requiredExternals = [];\n\t\t\tif (this.optionalAmdExternalAsGlobal) {\n\t\t\t\tfor (const m of externals) {\n\t\t\t\t\tif (m.optional) {\n\t\t\t\t\t\toptionalExternals.push(m);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trequiredExternals.push(m);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\texternals = requiredExternals.concat(optionalExternals);\n\t\t\t} else {\n\t\t\t\trequiredExternals = externals;\n\t\t\t}\n\n\t\t\tconst replaceKeys = str => {\n\t\t\t\treturn mainTemplate.getAssetPath(str, {\n\t\t\t\t\thash,\n\t\t\t\t\tchunk\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst externalsDepsArray = modules => {\n\t\t\t\treturn `[${replaceKeys(\n\t\t\t\t\tmodules\n\t\t\t\t\t\t.map(m =>\n\t\t\t\t\t\t\tJSON.stringify(\n\t\t\t\t\t\t\t\ttypeof m.request === \"object\" ? m.request.amd : m.request\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t)}]`;\n\t\t\t};\n\n\t\t\tconst externalsRootArray = modules => {\n\t\t\t\treturn replaceKeys(\n\t\t\t\t\tmodules\n\t\t\t\t\t\t.map(m => {\n\t\t\t\t\t\t\tlet request = m.request;\n\t\t\t\t\t\t\tif (typeof request === \"object\") request = request.root;\n\t\t\t\t\t\t\treturn `root${accessorToObjectAccess([].concat(request))}`;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t);\n\t\t\t};\n\n\t\t\tconst externalsRequireArray = type => {\n\t\t\t\treturn replaceKeys(\n\t\t\t\t\texternals\n\t\t\t\t\t\t.map(m => {\n\t\t\t\t\t\t\tlet expr;\n\t\t\t\t\t\t\tlet request = m.request;\n\t\t\t\t\t\t\tif (typeof request === \"object\") {\n\t\t\t\t\t\t\t\trequest = request[type];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (request === undefined) {\n\t\t\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t\t\t\"Missing external configuration for type:\" + type\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (Array.isArray(request)) {\n\t\t\t\t\t\t\t\texpr = `require(${JSON.stringify(\n\t\t\t\t\t\t\t\t\trequest[0]\n\t\t\t\t\t\t\t\t)})${accessorToObjectAccess(request.slice(1))}`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\texpr = `require(${JSON.stringify(request)})`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (m.optional) {\n\t\t\t\t\t\t\t\texpr = `(function webpackLoadOptionalExternalModule() { try { return ${expr}; } catch(e) {} }())`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn expr;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join(\", \")\n\t\t\t\t);\n\t\t\t};\n\n\t\t\tconst externalsArguments = modules => {\n\t\t\t\treturn modules\n\t\t\t\t\t.map(\n\t\t\t\t\t\tm =>\n\t\t\t\t\t\t\t`__WEBPACK_EXTERNAL_MODULE_${Template.toIdentifier(`${m.id}`)}__`\n\t\t\t\t\t)\n\t\t\t\t\t.join(\", \");\n\t\t\t};\n\n\t\t\tconst libraryName = library => {\n\t\t\t\treturn JSON.stringify(replaceKeys([].concat(library).pop()));\n\t\t\t};\n\n\t\t\tlet amdFactory;\n\t\t\tif (optionalExternals.length > 0) {\n\t\t\t\tconst wrapperArguments = externalsArguments(requiredExternals);\n\t\t\t\tconst factoryArguments =\n\t\t\t\t\trequiredExternals.length > 0\n\t\t\t\t\t\t? externalsArguments(requiredExternals) +\n\t\t\t\t\t\t  \", \" +\n\t\t\t\t\t\t  externalsRootArray(optionalExternals)\n\t\t\t\t\t\t: externalsRootArray(optionalExternals);\n\t\t\t\tamdFactory =\n\t\t\t\t\t`function webpackLoadOptionalExternalModuleAmd(${wrapperArguments}) {\\n` +\n\t\t\t\t\t`\t\t\treturn factory(${factoryArguments});\\n` +\n\t\t\t\t\t\"\t\t}\";\n\t\t\t} else {\n\t\t\t\tamdFactory = \"factory\";\n\t\t\t}\n\n\t\t\tconst auxiliaryComment = this.auxiliaryComment;\n\n\t\t\tconst getAuxilaryComment = type => {\n\t\t\t\tif (auxiliaryComment) {\n\t\t\t\t\tif (typeof auxiliaryComment === \"string\")\n\t\t\t\t\t\treturn \"\\t//\" + auxiliaryComment + \"\\n\";\n\t\t\t\t\tif (auxiliaryComment[type])\n\t\t\t\t\t\treturn \"\\t//\" + auxiliaryComment[type] + \"\\n\";\n\t\t\t\t}\n\t\t\t\treturn \"\";\n\t\t\t};\n\n\t\t\treturn new ConcatSource(\n\t\t\t\tnew OriginalSource(\n\t\t\t\t\t\"(function webpackUniversalModuleDefinition(root, factory) {\\n\" +\n\t\t\t\t\t\tgetAuxilaryComment(\"commonjs2\") +\n\t\t\t\t\t\t\"\tif(typeof exports === 'object' && typeof module === 'object')\\n\" +\n\t\t\t\t\t\t\"\t\tmodule.exports = factory(\" +\n\t\t\t\t\t\texternalsRequireArray(\"commonjs2\") +\n\t\t\t\t\t\t\");\\n\" +\n\t\t\t\t\t\tgetAuxilaryComment(\"amd\") +\n\t\t\t\t\t\t\"\telse if(typeof define === 'function' && define.amd)\\n\" +\n\t\t\t\t\t\t(requiredExternals.length > 0\n\t\t\t\t\t\t\t? this.names.amd && this.namedDefine === true\n\t\t\t\t\t\t\t\t? \"\t\tdefine(\" +\n\t\t\t\t\t\t\t\t  libraryName(this.names.amd) +\n\t\t\t\t\t\t\t\t  \", \" +\n\t\t\t\t\t\t\t\t  externalsDepsArray(requiredExternals) +\n\t\t\t\t\t\t\t\t  \", \" +\n\t\t\t\t\t\t\t\t  amdFactory +\n\t\t\t\t\t\t\t\t  \");\\n\"\n\t\t\t\t\t\t\t\t: \"\t\tdefine(\" +\n\t\t\t\t\t\t\t\t  externalsDepsArray(requiredExternals) +\n\t\t\t\t\t\t\t\t  \", \" +\n\t\t\t\t\t\t\t\t  amdFactory +\n\t\t\t\t\t\t\t\t  \");\\n\"\n\t\t\t\t\t\t\t: this.names.amd && this.namedDefine === true\n\t\t\t\t\t\t\t? \"\t\tdefine(\" +\n\t\t\t\t\t\t\t  libraryName(this.names.amd) +\n\t\t\t\t\t\t\t  \", [], \" +\n\t\t\t\t\t\t\t  amdFactory +\n\t\t\t\t\t\t\t  \");\\n\"\n\t\t\t\t\t\t\t: \"\t\tdefine([], \" + amdFactory + \");\\n\") +\n\t\t\t\t\t\t(this.names.root || this.names.commonjs\n\t\t\t\t\t\t\t? getAuxilaryComment(\"commonjs\") +\n\t\t\t\t\t\t\t  \"\telse if(typeof exports === 'object')\\n\" +\n\t\t\t\t\t\t\t  \"\t\texports[\" +\n\t\t\t\t\t\t\t  libraryName(this.names.commonjs || this.names.root) +\n\t\t\t\t\t\t\t  \"] = factory(\" +\n\t\t\t\t\t\t\t  externalsRequireArray(\"commonjs\") +\n\t\t\t\t\t\t\t  \");\\n\" +\n\t\t\t\t\t\t\t  getAuxilaryComment(\"root\") +\n\t\t\t\t\t\t\t  \"\telse\\n\" +\n\t\t\t\t\t\t\t  \"\t\t\" +\n\t\t\t\t\t\t\t  replaceKeys(\n\t\t\t\t\t\t\t\t\taccessorAccess(\"root\", this.names.root || this.names.commonjs)\n\t\t\t\t\t\t\t  ) +\n\t\t\t\t\t\t\t  \" = factory(\" +\n\t\t\t\t\t\t\t  externalsRootArray(externals) +\n\t\t\t\t\t\t\t  \");\\n\"\n\t\t\t\t\t\t\t: \"\telse {\\n\" +\n\t\t\t\t\t\t\t  (externals.length > 0\n\t\t\t\t\t\t\t\t\t? \"\t\tvar a = typeof exports === 'object' ? factory(\" +\n\t\t\t\t\t\t\t\t\t  externalsRequireArray(\"commonjs\") +\n\t\t\t\t\t\t\t\t\t  \") : factory(\" +\n\t\t\t\t\t\t\t\t\t  externalsRootArray(externals) +\n\t\t\t\t\t\t\t\t\t  \");\\n\"\n\t\t\t\t\t\t\t\t\t: \"\t\tvar a = factory();\\n\") +\n\t\t\t\t\t\t\t  \"\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\\n\" +\n\t\t\t\t\t\t\t  \"\t}\\n\") +\n\t\t\t\t\t\t`})(${\n\t\t\t\t\t\t\truntimeTemplate.outputOptions.globalObject\n\t\t\t\t\t\t}, function(${externalsArguments(externals)}) {\\nreturn `,\n\t\t\t\t\t\"webpack/universalModuleDefinition\"\n\t\t\t\t),\n\t\t\t\tsource,\n\t\t\t\t\";\\n})\"\n\t\t\t);\n\t\t};\n\n\t\tfor (const template of [mainTemplate, chunkTemplate]) {\n\t\t\ttemplate.hooks.renderWithEntry.tap(\n\t\t\t\t\"UmdMainTemplatePlugin\",\n\t\t\t\tonRenderWithEntry\n\t\t\t);\n\t\t}\n\n\t\tmainTemplate.hooks.globalHashPaths.tap(\"UmdMainTemplatePlugin\", paths => {\n\t\t\tif (this.names.root) paths = paths.concat(this.names.root);\n\t\t\tif (this.names.amd) paths = paths.concat(this.names.amd);\n\t\t\tif (this.names.commonjs) paths = paths.concat(this.names.commonjs);\n\t\t\treturn paths;\n\t\t});\n\n\t\tmainTemplate.hooks.hash.tap(\"UmdMainTemplatePlugin\", hash => {\n\t\t\thash.update(\"umd\");\n\t\t\thash.update(`${this.names.root}`);\n\t\t\thash.update(`${this.names.amd}`);\n\t\t\thash.update(`${this.names.commonjs}`);\n\t\t});\n\t}\n}\n\nmodule.exports = UmdMainTemplatePlugin;\n"]},"metadata":{},"sourceType":"script"}