{"ast":null,"code":"'use strict';\n\nvar util = require('./_util');\n\nmodule.exports = function defFunc(ajv) {\n  defFunc.definition = {\n    type: 'object',\n    macro: function (schema) {\n      var schemas = [];\n\n      for (var pointer in schema) schemas.push(getSchema(pointer, schema[pointer]));\n\n      return {\n        'allOf': schemas\n      };\n    },\n    metaSchema: {\n      type: 'object',\n      propertyNames: {\n        type: 'string',\n        format: 'json-pointer'\n      },\n      additionalProperties: util.metaSchemaRef(ajv)\n    }\n  };\n  ajv.addKeyword('deepProperties', defFunc.definition);\n  return ajv;\n};\n\nfunction getSchema(jsonPointer, schema) {\n  var segments = jsonPointer.split('/');\n  var rootSchema = {};\n  var pointerSchema = rootSchema;\n\n  for (var i = 1; i < segments.length; i++) {\n    var segment = segments[i];\n    var isLast = i == segments.length - 1;\n    segment = unescapeJsonPointer(segment);\n    var properties = pointerSchema.properties = {};\n    var items = undefined;\n\n    if (/[0-9]+/.test(segment)) {\n      var count = +segment;\n      items = pointerSchema.items = [];\n\n      while (count--) items.push({});\n    }\n\n    pointerSchema = isLast ? schema : {};\n    properties[segment] = pointerSchema;\n    if (items) items.push(pointerSchema);\n  }\n\n  return rootSchema;\n}\n\nfunction unescapeJsonPointer(str) {\n  return str.replace(/~1/g, '/').replace(/~0/g, '~');\n}","map":{"version":3,"sources":["/Users/hamzakhan/Documents/twitter-react/twitter/node_modules/ajv-keywords/keywords/deepProperties.js"],"names":["util","require","module","exports","defFunc","ajv","definition","type","macro","schema","schemas","pointer","push","getSchema","metaSchema","propertyNames","format","additionalProperties","metaSchemaRef","addKeyword","jsonPointer","segments","split","rootSchema","pointerSchema","i","length","segment","isLast","unescapeJsonPointer","properties","items","undefined","test","count","str","replace"],"mappings":"AAAA;;AAEA,IAAIA,IAAI,GAAGC,OAAO,CAAC,SAAD,CAAlB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,OAAT,CAAiBC,GAAjB,EAAsB;AACrCD,EAAAA,OAAO,CAACE,UAAR,GAAqB;AACnBC,IAAAA,IAAI,EAAE,QADa;AAEnBC,IAAAA,KAAK,EAAE,UAAUC,MAAV,EAAkB;AACvB,UAAIC,OAAO,GAAG,EAAd;;AACA,WAAK,IAAIC,OAAT,IAAoBF,MAApB,EACEC,OAAO,CAACE,IAAR,CAAaC,SAAS,CAACF,OAAD,EAAUF,MAAM,CAACE,OAAD,CAAhB,CAAtB;;AACF,aAAO;AAAC,iBAASD;AAAV,OAAP;AACD,KAPkB;AAQnBI,IAAAA,UAAU,EAAE;AACVP,MAAAA,IAAI,EAAE,QADI;AAEVQ,MAAAA,aAAa,EAAE;AACbR,QAAAA,IAAI,EAAE,QADO;AAEbS,QAAAA,MAAM,EAAE;AAFK,OAFL;AAMVC,MAAAA,oBAAoB,EAAEjB,IAAI,CAACkB,aAAL,CAAmBb,GAAnB;AANZ;AARO,GAArB;AAkBAA,EAAAA,GAAG,CAACc,UAAJ,CAAe,gBAAf,EAAiCf,OAAO,CAACE,UAAzC;AACA,SAAOD,GAAP;AACD,CArBD;;AAwBA,SAASQ,SAAT,CAAmBO,WAAnB,EAAgCX,MAAhC,EAAwC;AACtC,MAAIY,QAAQ,GAAGD,WAAW,CAACE,KAAZ,CAAkB,GAAlB,CAAf;AACA,MAAIC,UAAU,GAAG,EAAjB;AACA,MAAIC,aAAa,GAAGD,UAApB;;AACA,OAAK,IAAIE,CAAC,GAAC,CAAX,EAAcA,CAAC,GAACJ,QAAQ,CAACK,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AACpC,QAAIE,OAAO,GAAGN,QAAQ,CAACI,CAAD,CAAtB;AACA,QAAIG,MAAM,GAAGH,CAAC,IAAIJ,QAAQ,CAACK,MAAT,GAAkB,CAApC;AACAC,IAAAA,OAAO,GAAGE,mBAAmB,CAACF,OAAD,CAA7B;AACA,QAAIG,UAAU,GAAGN,aAAa,CAACM,UAAd,GAA2B,EAA5C;AACA,QAAIC,KAAK,GAAGC,SAAZ;;AACA,QAAI,SAASC,IAAT,CAAcN,OAAd,CAAJ,EAA4B;AAC1B,UAAIO,KAAK,GAAG,CAACP,OAAb;AACAI,MAAAA,KAAK,GAAGP,aAAa,CAACO,KAAd,GAAsB,EAA9B;;AACA,aAAOG,KAAK,EAAZ,EAAgBH,KAAK,CAACnB,IAAN,CAAW,EAAX;AACjB;;AACDY,IAAAA,aAAa,GAAGI,MAAM,GAAGnB,MAAH,GAAY,EAAlC;AACAqB,IAAAA,UAAU,CAACH,OAAD,CAAV,GAAsBH,aAAtB;AACA,QAAIO,KAAJ,EAAWA,KAAK,CAACnB,IAAN,CAAWY,aAAX;AACZ;;AACD,SAAOD,UAAP;AACD;;AAGD,SAASM,mBAAT,CAA6BM,GAA7B,EAAkC;AAChC,SAAOA,GAAG,CAACC,OAAJ,CAAY,KAAZ,EAAmB,GAAnB,EAAwBA,OAAxB,CAAgC,KAAhC,EAAuC,GAAvC,CAAP;AACD","sourcesContent":["'use strict';\n\nvar util = require('./_util');\n\nmodule.exports = function defFunc(ajv) {\n  defFunc.definition = {\n    type: 'object',\n    macro: function (schema) {\n      var schemas = [];\n      for (var pointer in schema)\n        schemas.push(getSchema(pointer, schema[pointer]));\n      return {'allOf': schemas};\n    },\n    metaSchema: {\n      type: 'object',\n      propertyNames: {\n        type: 'string',\n        format: 'json-pointer'\n      },\n      additionalProperties: util.metaSchemaRef(ajv)\n    }\n  };\n\n  ajv.addKeyword('deepProperties', defFunc.definition);\n  return ajv;\n};\n\n\nfunction getSchema(jsonPointer, schema) {\n  var segments = jsonPointer.split('/');\n  var rootSchema = {};\n  var pointerSchema = rootSchema;\n  for (var i=1; i<segments.length; i++) {\n    var segment = segments[i];\n    var isLast = i == segments.length - 1;\n    segment = unescapeJsonPointer(segment);\n    var properties = pointerSchema.properties = {};\n    var items = undefined;\n    if (/[0-9]+/.test(segment)) {\n      var count = +segment;\n      items = pointerSchema.items = [];\n      while (count--) items.push({});\n    }\n    pointerSchema = isLast ? schema : {};\n    properties[segment] = pointerSchema;\n    if (items) items.push(pointerSchema);\n  }\n  return rootSchema;\n}\n\n\nfunction unescapeJsonPointer(str) {\n  return str.replace(/~1/g, '/').replace(/~0/g, '~');\n}\n"]},"metadata":{},"sourceType":"script"}