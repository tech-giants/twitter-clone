{"ast":null,"code":"/*\n MIT License http://www.opensource.org/licenses/mit-license.php\n Author Tobias Koppers @sokra\n */\n\"use strict\";\n\nconst path = require(\"path\");\n\nconst asyncLib = require(\"neo-async\");\n\nconst {\n  Tapable,\n  AsyncSeriesWaterfallHook,\n  SyncWaterfallHook,\n  SyncBailHook,\n  SyncHook,\n  HookMap\n} = require(\"tapable\");\n\nconst NormalModule = require(\"./NormalModule\");\n\nconst RawModule = require(\"./RawModule\");\n\nconst RuleSet = require(\"./RuleSet\");\n\nconst {\n  cachedCleverMerge\n} = require(\"./util/cleverMerge\");\n\nconst EMPTY_RESOLVE_OPTIONS = {};\nconst MATCH_RESOURCE_REGEX = /^([^!]+)!=!/;\n\nconst loaderToIdent = data => {\n  if (!data.options) {\n    return data.loader;\n  }\n\n  if (typeof data.options === \"string\") {\n    return data.loader + \"?\" + data.options;\n  }\n\n  if (typeof data.options !== \"object\") {\n    throw new Error(\"loader options must be string or object\");\n  }\n\n  if (data.ident) {\n    return data.loader + \"??\" + data.ident;\n  }\n\n  return data.loader + \"?\" + JSON.stringify(data.options);\n};\n\nconst identToLoaderRequest = resultString => {\n  const idx = resultString.indexOf(\"?\");\n\n  if (idx >= 0) {\n    const loader = resultString.substr(0, idx);\n    const options = resultString.substr(idx + 1);\n    return {\n      loader,\n      options\n    };\n  } else {\n    return {\n      loader: resultString,\n      options: undefined\n    };\n  }\n};\n\nconst dependencyCache = new WeakMap();\n\nclass NormalModuleFactory extends Tapable {\n  constructor(context, resolverFactory, options) {\n    super();\n    this.hooks = {\n      resolver: new SyncWaterfallHook([\"resolver\"]),\n      factory: new SyncWaterfallHook([\"factory\"]),\n      beforeResolve: new AsyncSeriesWaterfallHook([\"data\"]),\n      afterResolve: new AsyncSeriesWaterfallHook([\"data\"]),\n      createModule: new SyncBailHook([\"data\"]),\n      module: new SyncWaterfallHook([\"module\", \"data\"]),\n      createParser: new HookMap(() => new SyncBailHook([\"parserOptions\"])),\n      parser: new HookMap(() => new SyncHook([\"parser\", \"parserOptions\"])),\n      createGenerator: new HookMap(() => new SyncBailHook([\"generatorOptions\"])),\n      generator: new HookMap(() => new SyncHook([\"generator\", \"generatorOptions\"]))\n    };\n\n    this._pluginCompat.tap(\"NormalModuleFactory\", options => {\n      switch (options.name) {\n        case \"before-resolve\":\n        case \"after-resolve\":\n          options.async = true;\n          break;\n\n        case \"parser\":\n          this.hooks.parser.for(\"javascript/auto\").tap(options.fn.name || \"unnamed compat plugin\", options.fn);\n          return true;\n      }\n\n      let match;\n      match = /^parser (.+)$/.exec(options.name);\n\n      if (match) {\n        this.hooks.parser.for(match[1]).tap(options.fn.name || \"unnamed compat plugin\", options.fn.bind(this));\n        return true;\n      }\n\n      match = /^create-parser (.+)$/.exec(options.name);\n\n      if (match) {\n        this.hooks.createParser.for(match[1]).tap(options.fn.name || \"unnamed compat plugin\", options.fn.bind(this));\n        return true;\n      }\n    });\n\n    this.resolverFactory = resolverFactory;\n    this.ruleSet = new RuleSet(options.defaultRules.concat(options.rules));\n    this.cachePredicate = typeof options.unsafeCache === \"function\" ? options.unsafeCache : Boolean.bind(null, options.unsafeCache);\n    this.context = context || \"\";\n    this.parserCache = Object.create(null);\n    this.generatorCache = Object.create(null);\n    this.hooks.factory.tap(\"NormalModuleFactory\", () => (result, callback) => {\n      let resolver = this.hooks.resolver.call(null); // Ignored\n\n      if (!resolver) return callback();\n      resolver(result, (err, data) => {\n        if (err) return callback(err); // Ignored\n\n        if (!data) return callback(); // direct module\n\n        if (typeof data.source === \"function\") return callback(null, data);\n        this.hooks.afterResolve.callAsync(data, (err, result) => {\n          if (err) return callback(err); // Ignored\n\n          if (!result) return callback();\n          let createdModule = this.hooks.createModule.call(result);\n\n          if (!createdModule) {\n            if (!result.request) {\n              return callback(new Error(\"Empty dependency (no request)\"));\n            }\n\n            createdModule = new NormalModule(result);\n          }\n\n          createdModule = this.hooks.module.call(createdModule, result);\n          return callback(null, createdModule);\n        });\n      });\n    });\n    this.hooks.resolver.tap(\"NormalModuleFactory\", () => (data, callback) => {\n      const contextInfo = data.contextInfo;\n      const context = data.context;\n      const request = data.request;\n      const loaderResolver = this.getResolver(\"loader\");\n      const normalResolver = this.getResolver(\"normal\", data.resolveOptions);\n      let matchResource = undefined;\n      let requestWithoutMatchResource = request;\n      const matchResourceMatch = MATCH_RESOURCE_REGEX.exec(request);\n\n      if (matchResourceMatch) {\n        matchResource = matchResourceMatch[1];\n\n        if (/^\\.\\.?\\//.test(matchResource)) {\n          matchResource = path.join(context, matchResource);\n        }\n\n        requestWithoutMatchResource = request.substr(matchResourceMatch[0].length);\n      }\n\n      const noPreAutoLoaders = requestWithoutMatchResource.startsWith(\"-!\");\n      const noAutoLoaders = noPreAutoLoaders || requestWithoutMatchResource.startsWith(\"!\");\n      const noPrePostAutoLoaders = requestWithoutMatchResource.startsWith(\"!!\");\n      let elements = requestWithoutMatchResource.replace(/^-?!+/, \"\").replace(/!!+/g, \"!\").split(\"!\");\n      let resource = elements.pop();\n      elements = elements.map(identToLoaderRequest);\n      asyncLib.parallel([callback => this.resolveRequestArray(contextInfo, context, elements, loaderResolver, callback), callback => {\n        if (resource === \"\" || resource[0] === \"?\") {\n          return callback(null, {\n            resource\n          });\n        }\n\n        normalResolver.resolve(contextInfo, context, resource, {}, (err, resource, resourceResolveData) => {\n          if (err) return callback(err);\n          callback(null, {\n            resourceResolveData,\n            resource\n          });\n        });\n      }], (err, results) => {\n        if (err) return callback(err);\n        let loaders = results[0];\n        const resourceResolveData = results[1].resourceResolveData;\n        resource = results[1].resource; // translate option idents\n\n        try {\n          for (const item of loaders) {\n            if (typeof item.options === \"string\" && item.options[0] === \"?\") {\n              const ident = item.options.substr(1);\n              item.options = this.ruleSet.findOptionsByIdent(ident);\n              item.ident = ident;\n            }\n          }\n        } catch (e) {\n          return callback(e);\n        }\n\n        if (resource === false) {\n          // ignored\n          return callback(null, new RawModule(\"/* (ignored) */\", `ignored ${context} ${request}`, `${request} (ignored)`));\n        }\n\n        const userRequest = (matchResource !== undefined ? `${matchResource}!=!` : \"\") + loaders.map(loaderToIdent).concat([resource]).join(\"!\");\n        let resourcePath = matchResource !== undefined ? matchResource : resource;\n        let resourceQuery = \"\";\n        const queryIndex = resourcePath.indexOf(\"?\");\n\n        if (queryIndex >= 0) {\n          resourceQuery = resourcePath.substr(queryIndex);\n          resourcePath = resourcePath.substr(0, queryIndex);\n        }\n\n        const result = this.ruleSet.exec({\n          resource: resourcePath,\n          realResource: matchResource !== undefined ? resource.replace(/\\?.*/, \"\") : resourcePath,\n          resourceQuery,\n          issuer: contextInfo.issuer,\n          compiler: contextInfo.compiler\n        });\n        const settings = {};\n        const useLoadersPost = [];\n        const useLoaders = [];\n        const useLoadersPre = [];\n\n        for (const r of result) {\n          if (r.type === \"use\") {\n            if (r.enforce === \"post\" && !noPrePostAutoLoaders) {\n              useLoadersPost.push(r.value);\n            } else if (r.enforce === \"pre\" && !noPreAutoLoaders && !noPrePostAutoLoaders) {\n              useLoadersPre.push(r.value);\n            } else if (!r.enforce && !noAutoLoaders && !noPrePostAutoLoaders) {\n              useLoaders.push(r.value);\n            }\n          } else if (typeof r.value === \"object\" && r.value !== null && typeof settings[r.type] === \"object\" && settings[r.type] !== null) {\n            settings[r.type] = cachedCleverMerge(settings[r.type], r.value);\n          } else {\n            settings[r.type] = r.value;\n          }\n        }\n\n        asyncLib.parallel([this.resolveRequestArray.bind(this, contextInfo, this.context, useLoadersPost, loaderResolver), this.resolveRequestArray.bind(this, contextInfo, this.context, useLoaders, loaderResolver), this.resolveRequestArray.bind(this, contextInfo, this.context, useLoadersPre, loaderResolver)], (err, results) => {\n          if (err) return callback(err);\n\n          if (matchResource === undefined) {\n            loaders = results[0].concat(loaders, results[1], results[2]);\n          } else {\n            loaders = results[0].concat(results[1], loaders, results[2]);\n          }\n\n          process.nextTick(() => {\n            const type = settings.type;\n            const resolveOptions = settings.resolve;\n            callback(null, {\n              context: context,\n              request: loaders.map(loaderToIdent).concat([resource]).join(\"!\"),\n              dependencies: data.dependencies,\n              userRequest,\n              rawRequest: request,\n              loaders,\n              resource,\n              matchResource,\n              resourceResolveData,\n              settings,\n              type,\n              parser: this.getParser(type, settings.parser),\n              generator: this.getGenerator(type, settings.generator),\n              resolveOptions\n            });\n          });\n        });\n      });\n    });\n  }\n\n  create(data, callback) {\n    const dependencies = data.dependencies;\n    const cacheEntry = dependencyCache.get(dependencies[0]);\n    if (cacheEntry) return callback(null, cacheEntry);\n    const context = data.context || this.context;\n    const resolveOptions = data.resolveOptions || EMPTY_RESOLVE_OPTIONS;\n    const request = dependencies[0].request;\n    const contextInfo = data.contextInfo || {};\n    this.hooks.beforeResolve.callAsync({\n      contextInfo,\n      resolveOptions,\n      context,\n      request,\n      dependencies\n    }, (err, result) => {\n      if (err) return callback(err); // Ignored\n\n      if (!result) return callback();\n      const factory = this.hooks.factory.call(null); // Ignored\n\n      if (!factory) return callback();\n      factory(result, (err, module) => {\n        if (err) return callback(err);\n\n        if (module && this.cachePredicate(module)) {\n          for (const d of dependencies) {\n            dependencyCache.set(d, module);\n          }\n        }\n\n        callback(null, module);\n      });\n    });\n  }\n\n  resolveRequestArray(contextInfo, context, array, resolver, callback) {\n    if (array.length === 0) return callback(null, []);\n    asyncLib.map(array, (item, callback) => {\n      resolver.resolve(contextInfo, context, item.loader, {}, (err, result) => {\n        if (err && /^[^/]*$/.test(item.loader) && !/-loader$/.test(item.loader)) {\n          return resolver.resolve(contextInfo, context, item.loader + \"-loader\", {}, err2 => {\n            if (!err2) {\n              err.message = err.message + \"\\n\" + \"BREAKING CHANGE: It's no longer allowed to omit the '-loader' suffix when using loaders.\\n\" + `                 You need to specify '${item.loader}-loader' instead of '${item.loader}',\\n` + \"                 see https://webpack.js.org/migrate/3/#automatic-loader-module-name-extension-removed\";\n            }\n\n            callback(err);\n          });\n        }\n\n        if (err) return callback(err);\n        const optionsOnly = item.options ? {\n          options: item.options\n        } : undefined;\n        return callback(null, Object.assign({}, item, identToLoaderRequest(result), optionsOnly));\n      });\n    }, callback);\n  }\n\n  getParser(type, parserOptions) {\n    let ident = type;\n\n    if (parserOptions) {\n      if (parserOptions.ident) {\n        ident = `${type}|${parserOptions.ident}`;\n      } else {\n        ident = JSON.stringify([type, parserOptions]);\n      }\n    }\n\n    if (ident in this.parserCache) {\n      return this.parserCache[ident];\n    }\n\n    return this.parserCache[ident] = this.createParser(type, parserOptions);\n  }\n\n  createParser(type, parserOptions = {}) {\n    const parser = this.hooks.createParser.for(type).call(parserOptions);\n\n    if (!parser) {\n      throw new Error(`No parser registered for ${type}`);\n    }\n\n    this.hooks.parser.for(type).call(parser, parserOptions);\n    return parser;\n  }\n\n  getGenerator(type, generatorOptions) {\n    let ident = type;\n\n    if (generatorOptions) {\n      if (generatorOptions.ident) {\n        ident = `${type}|${generatorOptions.ident}`;\n      } else {\n        ident = JSON.stringify([type, generatorOptions]);\n      }\n    }\n\n    if (ident in this.generatorCache) {\n      return this.generatorCache[ident];\n    }\n\n    return this.generatorCache[ident] = this.createGenerator(type, generatorOptions);\n  }\n\n  createGenerator(type, generatorOptions = {}) {\n    const generator = this.hooks.createGenerator.for(type).call(generatorOptions);\n\n    if (!generator) {\n      throw new Error(`No generator registered for ${type}`);\n    }\n\n    this.hooks.generator.for(type).call(generator, generatorOptions);\n    return generator;\n  }\n\n  getResolver(type, resolveOptions) {\n    return this.resolverFactory.get(type, resolveOptions || EMPTY_RESOLVE_OPTIONS);\n  }\n\n}\n\nmodule.exports = NormalModuleFactory;","map":{"version":3,"sources":["/Users/hamzakhan/Documents/twitter-react/twitter/node_modules/webpack/lib/NormalModuleFactory.js"],"names":["path","require","asyncLib","Tapable","AsyncSeriesWaterfallHook","SyncWaterfallHook","SyncBailHook","SyncHook","HookMap","NormalModule","RawModule","RuleSet","cachedCleverMerge","EMPTY_RESOLVE_OPTIONS","MATCH_RESOURCE_REGEX","loaderToIdent","data","options","loader","Error","ident","JSON","stringify","identToLoaderRequest","resultString","idx","indexOf","substr","undefined","dependencyCache","WeakMap","NormalModuleFactory","constructor","context","resolverFactory","hooks","resolver","factory","beforeResolve","afterResolve","createModule","module","createParser","parser","createGenerator","generator","_pluginCompat","tap","name","async","for","fn","match","exec","bind","ruleSet","defaultRules","concat","rules","cachePredicate","unsafeCache","Boolean","parserCache","Object","create","generatorCache","result","callback","call","err","source","callAsync","createdModule","request","contextInfo","loaderResolver","getResolver","normalResolver","resolveOptions","matchResource","requestWithoutMatchResource","matchResourceMatch","test","join","length","noPreAutoLoaders","startsWith","noAutoLoaders","noPrePostAutoLoaders","elements","replace","split","resource","pop","map","parallel","resolveRequestArray","resolve","resourceResolveData","results","loaders","item","findOptionsByIdent","e","userRequest","resourcePath","resourceQuery","queryIndex","realResource","issuer","compiler","settings","useLoadersPost","useLoaders","useLoadersPre","r","type","enforce","push","value","process","nextTick","dependencies","rawRequest","getParser","getGenerator","cacheEntry","get","d","set","array","err2","message","optionsOnly","assign","parserOptions","generatorOptions","exports"],"mappings":"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","sourcesContent":["/*\n MIT License http://www.opensource.org/licenses/mit-license.php\n Author Tobias Koppers @sokra\n */\n\"use strict\";\n\nconst path = require(\"path\");\nconst asyncLib = require(\"neo-async\");\nconst {\n\tTapable,\n\tAsyncSeriesWaterfallHook,\n\tSyncWaterfallHook,\n\tSyncBailHook,\n\tSyncHook,\n\tHookMap\n} = require(\"tapable\");\nconst NormalModule = require(\"./NormalModule\");\nconst RawModule = require(\"./RawModule\");\nconst RuleSet = require(\"./RuleSet\");\nconst { cachedCleverMerge } = require(\"./util/cleverMerge\");\n\nconst EMPTY_RESOLVE_OPTIONS = {};\n\nconst MATCH_RESOURCE_REGEX = /^([^!]+)!=!/;\n\nconst loaderToIdent = data => {\n\tif (!data.options) {\n\t\treturn data.loader;\n\t}\n\tif (typeof data.options === \"string\") {\n\t\treturn data.loader + \"?\" + data.options;\n\t}\n\tif (typeof data.options !== \"object\") {\n\t\tthrow new Error(\"loader options must be string or object\");\n\t}\n\tif (data.ident) {\n\t\treturn data.loader + \"??\" + data.ident;\n\t}\n\treturn data.loader + \"?\" + JSON.stringify(data.options);\n};\n\nconst identToLoaderRequest = resultString => {\n\tconst idx = resultString.indexOf(\"?\");\n\tif (idx >= 0) {\n\t\tconst loader = resultString.substr(0, idx);\n\t\tconst options = resultString.substr(idx + 1);\n\t\treturn {\n\t\t\tloader,\n\t\t\toptions\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tloader: resultString,\n\t\t\toptions: undefined\n\t\t};\n\t}\n};\n\nconst dependencyCache = new WeakMap();\n\nclass NormalModuleFactory extends Tapable {\n\tconstructor(context, resolverFactory, options) {\n\t\tsuper();\n\t\tthis.hooks = {\n\t\t\tresolver: new SyncWaterfallHook([\"resolver\"]),\n\t\t\tfactory: new SyncWaterfallHook([\"factory\"]),\n\t\t\tbeforeResolve: new AsyncSeriesWaterfallHook([\"data\"]),\n\t\t\tafterResolve: new AsyncSeriesWaterfallHook([\"data\"]),\n\t\t\tcreateModule: new SyncBailHook([\"data\"]),\n\t\t\tmodule: new SyncWaterfallHook([\"module\", \"data\"]),\n\t\t\tcreateParser: new HookMap(() => new SyncBailHook([\"parserOptions\"])),\n\t\t\tparser: new HookMap(() => new SyncHook([\"parser\", \"parserOptions\"])),\n\t\t\tcreateGenerator: new HookMap(\n\t\t\t\t() => new SyncBailHook([\"generatorOptions\"])\n\t\t\t),\n\t\t\tgenerator: new HookMap(\n\t\t\t\t() => new SyncHook([\"generator\", \"generatorOptions\"])\n\t\t\t)\n\t\t};\n\t\tthis._pluginCompat.tap(\"NormalModuleFactory\", options => {\n\t\t\tswitch (options.name) {\n\t\t\t\tcase \"before-resolve\":\n\t\t\t\tcase \"after-resolve\":\n\t\t\t\t\toptions.async = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"parser\":\n\t\t\t\t\tthis.hooks.parser\n\t\t\t\t\t\t.for(\"javascript/auto\")\n\t\t\t\t\t\t.tap(options.fn.name || \"unnamed compat plugin\", options.fn);\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet match;\n\t\t\tmatch = /^parser (.+)$/.exec(options.name);\n\t\t\tif (match) {\n\t\t\t\tthis.hooks.parser\n\t\t\t\t\t.for(match[1])\n\t\t\t\t\t.tap(\n\t\t\t\t\t\toptions.fn.name || \"unnamed compat plugin\",\n\t\t\t\t\t\toptions.fn.bind(this)\n\t\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tmatch = /^create-parser (.+)$/.exec(options.name);\n\t\t\tif (match) {\n\t\t\t\tthis.hooks.createParser\n\t\t\t\t\t.for(match[1])\n\t\t\t\t\t.tap(\n\t\t\t\t\t\toptions.fn.name || \"unnamed compat plugin\",\n\t\t\t\t\t\toptions.fn.bind(this)\n\t\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\tthis.resolverFactory = resolverFactory;\n\t\tthis.ruleSet = new RuleSet(options.defaultRules.concat(options.rules));\n\t\tthis.cachePredicate =\n\t\t\ttypeof options.unsafeCache === \"function\"\n\t\t\t\t? options.unsafeCache\n\t\t\t\t: Boolean.bind(null, options.unsafeCache);\n\t\tthis.context = context || \"\";\n\t\tthis.parserCache = Object.create(null);\n\t\tthis.generatorCache = Object.create(null);\n\t\tthis.hooks.factory.tap(\"NormalModuleFactory\", () => (result, callback) => {\n\t\t\tlet resolver = this.hooks.resolver.call(null);\n\n\t\t\t// Ignored\n\t\t\tif (!resolver) return callback();\n\n\t\t\tresolver(result, (err, data) => {\n\t\t\t\tif (err) return callback(err);\n\n\t\t\t\t// Ignored\n\t\t\t\tif (!data) return callback();\n\n\t\t\t\t// direct module\n\t\t\t\tif (typeof data.source === \"function\") return callback(null, data);\n\n\t\t\t\tthis.hooks.afterResolve.callAsync(data, (err, result) => {\n\t\t\t\t\tif (err) return callback(err);\n\n\t\t\t\t\t// Ignored\n\t\t\t\t\tif (!result) return callback();\n\n\t\t\t\t\tlet createdModule = this.hooks.createModule.call(result);\n\t\t\t\t\tif (!createdModule) {\n\t\t\t\t\t\tif (!result.request) {\n\t\t\t\t\t\t\treturn callback(new Error(\"Empty dependency (no request)\"));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcreatedModule = new NormalModule(result);\n\t\t\t\t\t}\n\n\t\t\t\t\tcreatedModule = this.hooks.module.call(createdModule, result);\n\n\t\t\t\t\treturn callback(null, createdModule);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\tthis.hooks.resolver.tap(\"NormalModuleFactory\", () => (data, callback) => {\n\t\t\tconst contextInfo = data.contextInfo;\n\t\t\tconst context = data.context;\n\t\t\tconst request = data.request;\n\n\t\t\tconst loaderResolver = this.getResolver(\"loader\");\n\t\t\tconst normalResolver = this.getResolver(\"normal\", data.resolveOptions);\n\n\t\t\tlet matchResource = undefined;\n\t\t\tlet requestWithoutMatchResource = request;\n\t\t\tconst matchResourceMatch = MATCH_RESOURCE_REGEX.exec(request);\n\t\t\tif (matchResourceMatch) {\n\t\t\t\tmatchResource = matchResourceMatch[1];\n\t\t\t\tif (/^\\.\\.?\\//.test(matchResource)) {\n\t\t\t\t\tmatchResource = path.join(context, matchResource);\n\t\t\t\t}\n\t\t\t\trequestWithoutMatchResource = request.substr(\n\t\t\t\t\tmatchResourceMatch[0].length\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst noPreAutoLoaders = requestWithoutMatchResource.startsWith(\"-!\");\n\t\t\tconst noAutoLoaders =\n\t\t\t\tnoPreAutoLoaders || requestWithoutMatchResource.startsWith(\"!\");\n\t\t\tconst noPrePostAutoLoaders = requestWithoutMatchResource.startsWith(\"!!\");\n\t\t\tlet elements = requestWithoutMatchResource\n\t\t\t\t.replace(/^-?!+/, \"\")\n\t\t\t\t.replace(/!!+/g, \"!\")\n\t\t\t\t.split(\"!\");\n\t\t\tlet resource = elements.pop();\n\t\t\telements = elements.map(identToLoaderRequest);\n\n\t\t\tasyncLib.parallel(\n\t\t\t\t[\n\t\t\t\t\tcallback =>\n\t\t\t\t\t\tthis.resolveRequestArray(\n\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\telements,\n\t\t\t\t\t\t\tloaderResolver,\n\t\t\t\t\t\t\tcallback\n\t\t\t\t\t\t),\n\t\t\t\t\tcallback => {\n\t\t\t\t\t\tif (resource === \"\" || resource[0] === \"?\") {\n\t\t\t\t\t\t\treturn callback(null, {\n\t\t\t\t\t\t\t\tresource\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnormalResolver.resolve(\n\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t(err, resource, resourceResolveData) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tcallback(null, {\n\t\t\t\t\t\t\t\t\tresourceResolveData,\n\t\t\t\t\t\t\t\t\tresource\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t(err, results) => {\n\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\tlet loaders = results[0];\n\t\t\t\t\tconst resourceResolveData = results[1].resourceResolveData;\n\t\t\t\t\tresource = results[1].resource;\n\n\t\t\t\t\t// translate option idents\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor (const item of loaders) {\n\t\t\t\t\t\t\tif (typeof item.options === \"string\" && item.options[0] === \"?\") {\n\t\t\t\t\t\t\t\tconst ident = item.options.substr(1);\n\t\t\t\t\t\t\t\titem.options = this.ruleSet.findOptionsByIdent(ident);\n\t\t\t\t\t\t\t\titem.ident = ident;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn callback(e);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (resource === false) {\n\t\t\t\t\t\t// ignored\n\t\t\t\t\t\treturn callback(\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tnew RawModule(\n\t\t\t\t\t\t\t\t\"/* (ignored) */\",\n\t\t\t\t\t\t\t\t`ignored ${context} ${request}`,\n\t\t\t\t\t\t\t\t`${request} (ignored)`\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst userRequest =\n\t\t\t\t\t\t(matchResource !== undefined ? `${matchResource}!=!` : \"\") +\n\t\t\t\t\t\tloaders\n\t\t\t\t\t\t\t.map(loaderToIdent)\n\t\t\t\t\t\t\t.concat([resource])\n\t\t\t\t\t\t\t.join(\"!\");\n\n\t\t\t\t\tlet resourcePath =\n\t\t\t\t\t\tmatchResource !== undefined ? matchResource : resource;\n\t\t\t\t\tlet resourceQuery = \"\";\n\t\t\t\t\tconst queryIndex = resourcePath.indexOf(\"?\");\n\t\t\t\t\tif (queryIndex >= 0) {\n\t\t\t\t\t\tresourceQuery = resourcePath.substr(queryIndex);\n\t\t\t\t\t\tresourcePath = resourcePath.substr(0, queryIndex);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = this.ruleSet.exec({\n\t\t\t\t\t\tresource: resourcePath,\n\t\t\t\t\t\trealResource:\n\t\t\t\t\t\t\tmatchResource !== undefined\n\t\t\t\t\t\t\t\t? resource.replace(/\\?.*/, \"\")\n\t\t\t\t\t\t\t\t: resourcePath,\n\t\t\t\t\t\tresourceQuery,\n\t\t\t\t\t\tissuer: contextInfo.issuer,\n\t\t\t\t\t\tcompiler: contextInfo.compiler\n\t\t\t\t\t});\n\t\t\t\t\tconst settings = {};\n\t\t\t\t\tconst useLoadersPost = [];\n\t\t\t\t\tconst useLoaders = [];\n\t\t\t\t\tconst useLoadersPre = [];\n\t\t\t\t\tfor (const r of result) {\n\t\t\t\t\t\tif (r.type === \"use\") {\n\t\t\t\t\t\t\tif (r.enforce === \"post\" && !noPrePostAutoLoaders) {\n\t\t\t\t\t\t\t\tuseLoadersPost.push(r.value);\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\tr.enforce === \"pre\" &&\n\t\t\t\t\t\t\t\t!noPreAutoLoaders &&\n\t\t\t\t\t\t\t\t!noPrePostAutoLoaders\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tuseLoadersPre.push(r.value);\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\t!r.enforce &&\n\t\t\t\t\t\t\t\t!noAutoLoaders &&\n\t\t\t\t\t\t\t\t!noPrePostAutoLoaders\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tuseLoaders.push(r.value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\ttypeof r.value === \"object\" &&\n\t\t\t\t\t\t\tr.value !== null &&\n\t\t\t\t\t\t\ttypeof settings[r.type] === \"object\" &&\n\t\t\t\t\t\t\tsettings[r.type] !== null\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tsettings[r.type] = cachedCleverMerge(settings[r.type], r.value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsettings[r.type] = r.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tasyncLib.parallel(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.resolveRequestArray.bind(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\t\tthis.context,\n\t\t\t\t\t\t\t\tuseLoadersPost,\n\t\t\t\t\t\t\t\tloaderResolver\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.resolveRequestArray.bind(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\t\tthis.context,\n\t\t\t\t\t\t\t\tuseLoaders,\n\t\t\t\t\t\t\t\tloaderResolver\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.resolveRequestArray.bind(\n\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\t\tthis.context,\n\t\t\t\t\t\t\t\tuseLoadersPre,\n\t\t\t\t\t\t\t\tloaderResolver\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t],\n\t\t\t\t\t\t(err, results) => {\n\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\tif (matchResource === undefined) {\n\t\t\t\t\t\t\t\tloaders = results[0].concat(loaders, results[1], results[2]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tloaders = results[0].concat(results[1], loaders, results[2]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tprocess.nextTick(() => {\n\t\t\t\t\t\t\t\tconst type = settings.type;\n\t\t\t\t\t\t\t\tconst resolveOptions = settings.resolve;\n\t\t\t\t\t\t\t\tcallback(null, {\n\t\t\t\t\t\t\t\t\tcontext: context,\n\t\t\t\t\t\t\t\t\trequest: loaders\n\t\t\t\t\t\t\t\t\t\t.map(loaderToIdent)\n\t\t\t\t\t\t\t\t\t\t.concat([resource])\n\t\t\t\t\t\t\t\t\t\t.join(\"!\"),\n\t\t\t\t\t\t\t\t\tdependencies: data.dependencies,\n\t\t\t\t\t\t\t\t\tuserRequest,\n\t\t\t\t\t\t\t\t\trawRequest: request,\n\t\t\t\t\t\t\t\t\tloaders,\n\t\t\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\t\t\tmatchResource,\n\t\t\t\t\t\t\t\t\tresourceResolveData,\n\t\t\t\t\t\t\t\t\tsettings,\n\t\t\t\t\t\t\t\t\ttype,\n\t\t\t\t\t\t\t\t\tparser: this.getParser(type, settings.parser),\n\t\t\t\t\t\t\t\t\tgenerator: this.getGenerator(type, settings.generator),\n\t\t\t\t\t\t\t\t\tresolveOptions\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tcreate(data, callback) {\n\t\tconst dependencies = data.dependencies;\n\t\tconst cacheEntry = dependencyCache.get(dependencies[0]);\n\t\tif (cacheEntry) return callback(null, cacheEntry);\n\t\tconst context = data.context || this.context;\n\t\tconst resolveOptions = data.resolveOptions || EMPTY_RESOLVE_OPTIONS;\n\t\tconst request = dependencies[0].request;\n\t\tconst contextInfo = data.contextInfo || {};\n\t\tthis.hooks.beforeResolve.callAsync(\n\t\t\t{\n\t\t\t\tcontextInfo,\n\t\t\t\tresolveOptions,\n\t\t\t\tcontext,\n\t\t\t\trequest,\n\t\t\t\tdependencies\n\t\t\t},\n\t\t\t(err, result) => {\n\t\t\t\tif (err) return callback(err);\n\n\t\t\t\t// Ignored\n\t\t\t\tif (!result) return callback();\n\n\t\t\t\tconst factory = this.hooks.factory.call(null);\n\n\t\t\t\t// Ignored\n\t\t\t\tif (!factory) return callback();\n\n\t\t\t\tfactory(result, (err, module) => {\n\t\t\t\t\tif (err) return callback(err);\n\n\t\t\t\t\tif (module && this.cachePredicate(module)) {\n\t\t\t\t\t\tfor (const d of dependencies) {\n\t\t\t\t\t\t\tdependencyCache.set(d, module);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcallback(null, module);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n\tresolveRequestArray(contextInfo, context, array, resolver, callback) {\n\t\tif (array.length === 0) return callback(null, []);\n\t\tasyncLib.map(\n\t\t\tarray,\n\t\t\t(item, callback) => {\n\t\t\t\tresolver.resolve(\n\t\t\t\t\tcontextInfo,\n\t\t\t\t\tcontext,\n\t\t\t\t\titem.loader,\n\t\t\t\t\t{},\n\t\t\t\t\t(err, result) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\terr &&\n\t\t\t\t\t\t\t/^[^/]*$/.test(item.loader) &&\n\t\t\t\t\t\t\t!/-loader$/.test(item.loader)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn resolver.resolve(\n\t\t\t\t\t\t\t\tcontextInfo,\n\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\titem.loader + \"-loader\",\n\t\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t\terr2 => {\n\t\t\t\t\t\t\t\t\tif (!err2) {\n\t\t\t\t\t\t\t\t\t\terr.message =\n\t\t\t\t\t\t\t\t\t\t\terr.message +\n\t\t\t\t\t\t\t\t\t\t\t\"\\n\" +\n\t\t\t\t\t\t\t\t\t\t\t\"BREAKING CHANGE: It's no longer allowed to omit the '-loader' suffix when using loaders.\\n\" +\n\t\t\t\t\t\t\t\t\t\t\t`                 You need to specify '${item.loader}-loader' instead of '${item.loader}',\\n` +\n\t\t\t\t\t\t\t\t\t\t\t\"                 see https://webpack.js.org/migrate/3/#automatic-loader-module-name-extension-removed\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcallback(err);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (err) return callback(err);\n\n\t\t\t\t\t\tconst optionsOnly = item.options\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\toptions: item.options\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: undefined;\n\t\t\t\t\t\treturn callback(\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tObject.assign({}, item, identToLoaderRequest(result), optionsOnly)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t\tcallback\n\t\t);\n\t}\n\n\tgetParser(type, parserOptions) {\n\t\tlet ident = type;\n\t\tif (parserOptions) {\n\t\t\tif (parserOptions.ident) {\n\t\t\t\tident = `${type}|${parserOptions.ident}`;\n\t\t\t} else {\n\t\t\t\tident = JSON.stringify([type, parserOptions]);\n\t\t\t}\n\t\t}\n\t\tif (ident in this.parserCache) {\n\t\t\treturn this.parserCache[ident];\n\t\t}\n\t\treturn (this.parserCache[ident] = this.createParser(type, parserOptions));\n\t}\n\n\tcreateParser(type, parserOptions = {}) {\n\t\tconst parser = this.hooks.createParser.for(type).call(parserOptions);\n\t\tif (!parser) {\n\t\t\tthrow new Error(`No parser registered for ${type}`);\n\t\t}\n\t\tthis.hooks.parser.for(type).call(parser, parserOptions);\n\t\treturn parser;\n\t}\n\n\tgetGenerator(type, generatorOptions) {\n\t\tlet ident = type;\n\t\tif (generatorOptions) {\n\t\t\tif (generatorOptions.ident) {\n\t\t\t\tident = `${type}|${generatorOptions.ident}`;\n\t\t\t} else {\n\t\t\t\tident = JSON.stringify([type, generatorOptions]);\n\t\t\t}\n\t\t}\n\t\tif (ident in this.generatorCache) {\n\t\t\treturn this.generatorCache[ident];\n\t\t}\n\t\treturn (this.generatorCache[ident] = this.createGenerator(\n\t\t\ttype,\n\t\t\tgeneratorOptions\n\t\t));\n\t}\n\n\tcreateGenerator(type, generatorOptions = {}) {\n\t\tconst generator = this.hooks.createGenerator\n\t\t\t.for(type)\n\t\t\t.call(generatorOptions);\n\t\tif (!generator) {\n\t\t\tthrow new Error(`No generator registered for ${type}`);\n\t\t}\n\t\tthis.hooks.generator.for(type).call(generator, generatorOptions);\n\t\treturn generator;\n\t}\n\n\tgetResolver(type, resolveOptions) {\n\t\treturn this.resolverFactory.get(\n\t\t\ttype,\n\t\t\tresolveOptions || EMPTY_RESOLVE_OPTIONS\n\t\t);\n\t}\n}\n\nmodule.exports = NormalModuleFactory;\n"]},"metadata":{},"sourceType":"script"}