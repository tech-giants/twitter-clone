{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst ExternalModule = require(\"./ExternalModule\");\n\nclass ExternalModuleFactoryPlugin {\n  constructor(type, externals) {\n    this.type = type;\n    this.externals = externals;\n  }\n\n  apply(normalModuleFactory) {\n    const globalType = this.type;\n    normalModuleFactory.hooks.factory.tap(\"ExternalModuleFactoryPlugin\", factory => (data, callback) => {\n      const context = data.context;\n      const dependency = data.dependencies[0];\n\n      const handleExternal = (value, type, callback) => {\n        if (typeof type === \"function\") {\n          callback = type;\n          type = undefined;\n        }\n\n        if (value === false) return factory(data, callback);\n        if (value === true) value = dependency.request;\n\n        if (type === undefined && /^[a-z0-9]+ /.test(value)) {\n          const idx = value.indexOf(\" \");\n          type = value.substr(0, idx);\n          value = value.substr(idx + 1);\n        }\n\n        callback(null, new ExternalModule(value, type || globalType, dependency.request));\n        return true;\n      };\n\n      const handleExternals = (externals, callback) => {\n        if (typeof externals === \"string\") {\n          if (externals === dependency.request) {\n            return handleExternal(dependency.request, callback);\n          }\n        } else if (Array.isArray(externals)) {\n          let i = 0;\n\n          const next = () => {\n            let asyncFlag;\n\n            const handleExternalsAndCallback = (err, module) => {\n              if (err) return callback(err);\n\n              if (!module) {\n                if (asyncFlag) {\n                  asyncFlag = false;\n                  return;\n                }\n\n                return next();\n              }\n\n              callback(null, module);\n            };\n\n            do {\n              asyncFlag = true;\n              if (i >= externals.length) return callback();\n              handleExternals(externals[i++], handleExternalsAndCallback);\n            } while (!asyncFlag);\n\n            asyncFlag = false;\n          };\n\n          next();\n          return;\n        } else if (externals instanceof RegExp) {\n          if (externals.test(dependency.request)) {\n            return handleExternal(dependency.request, callback);\n          }\n        } else if (typeof externals === \"function\") {\n          externals.call(null, context, dependency.request, (err, value, type) => {\n            if (err) return callback(err);\n\n            if (value !== undefined) {\n              handleExternal(value, type, callback);\n            } else {\n              callback();\n            }\n          });\n          return;\n        } else if (typeof externals === \"object\" && Object.prototype.hasOwnProperty.call(externals, dependency.request)) {\n          return handleExternal(externals[dependency.request], callback);\n        }\n\n        callback();\n      };\n\n      handleExternals(this.externals, (err, module) => {\n        if (err) return callback(err);\n        if (!module) return handleExternal(false, callback);\n        return callback(null, module);\n      });\n    });\n  }\n\n}\n\nmodule.exports = ExternalModuleFactoryPlugin;","map":{"version":3,"sources":["/Users/hamzakhan/Documents/twitter-react/twitter/node_modules/webpack/lib/ExternalModuleFactoryPlugin.js"],"names":["ExternalModule","require","ExternalModuleFactoryPlugin","constructor","type","externals","apply","normalModuleFactory","globalType","hooks","factory","tap","data","callback","context","dependency","dependencies","handleExternal","value","undefined","request","test","idx","indexOf","substr","handleExternals","Array","isArray","i","next","asyncFlag","handleExternalsAndCallback","err","module","length","RegExp","call","Object","prototype","hasOwnProperty","exports"],"mappings":"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","sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst ExternalModule = require(\"./ExternalModule\");\n\nclass ExternalModuleFactoryPlugin {\n\tconstructor(type, externals) {\n\t\tthis.type = type;\n\t\tthis.externals = externals;\n\t}\n\n\tapply(normalModuleFactory) {\n\t\tconst globalType = this.type;\n\t\tnormalModuleFactory.hooks.factory.tap(\n\t\t\t\"ExternalModuleFactoryPlugin\",\n\t\t\tfactory => (data, callback) => {\n\t\t\t\tconst context = data.context;\n\t\t\t\tconst dependency = data.dependencies[0];\n\n\t\t\t\tconst handleExternal = (value, type, callback) => {\n\t\t\t\t\tif (typeof type === \"function\") {\n\t\t\t\t\t\tcallback = type;\n\t\t\t\t\t\ttype = undefined;\n\t\t\t\t\t}\n\t\t\t\t\tif (value === false) return factory(data, callback);\n\t\t\t\t\tif (value === true) value = dependency.request;\n\t\t\t\t\tif (type === undefined && /^[a-z0-9]+ /.test(value)) {\n\t\t\t\t\t\tconst idx = value.indexOf(\" \");\n\t\t\t\t\t\ttype = value.substr(0, idx);\n\t\t\t\t\t\tvalue = value.substr(idx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tcallback(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tnew ExternalModule(value, type || globalType, dependency.request)\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tconst handleExternals = (externals, callback) => {\n\t\t\t\t\tif (typeof externals === \"string\") {\n\t\t\t\t\t\tif (externals === dependency.request) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (Array.isArray(externals)) {\n\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\tconst next = () => {\n\t\t\t\t\t\t\tlet asyncFlag;\n\t\t\t\t\t\t\tconst handleExternalsAndCallback = (err, module) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tif (!module) {\n\t\t\t\t\t\t\t\t\tif (asyncFlag) {\n\t\t\t\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcallback(null, module);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\t\tasyncFlag = true;\n\t\t\t\t\t\t\t\tif (i >= externals.length) return callback();\n\t\t\t\t\t\t\t\thandleExternals(externals[i++], handleExternalsAndCallback);\n\t\t\t\t\t\t\t} while (!asyncFlag);\n\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tnext();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (externals instanceof RegExp) {\n\t\t\t\t\t\tif (externals.test(dependency.request)) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (typeof externals === \"function\") {\n\t\t\t\t\t\texternals.call(\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\tdependency.request,\n\t\t\t\t\t\t\t(err, value, type) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\t\t\t\thandleExternal(value, type, callback);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\ttypeof externals === \"object\" &&\n\t\t\t\t\t\tObject.prototype.hasOwnProperty.call(externals, dependency.request)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn handleExternal(externals[dependency.request], callback);\n\t\t\t\t\t}\n\t\t\t\t\tcallback();\n\t\t\t\t};\n\n\t\t\t\thandleExternals(this.externals, (err, module) => {\n\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\tif (!module) return handleExternal(false, callback);\n\t\t\t\t\treturn callback(null, module);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = ExternalModuleFactoryPlugin;\n"]},"metadata":{},"sourceType":"script"}