{"ast":null,"code":"\"use strict\";\n/**\n * trace-event - A library to create a trace of your node app per\n * Google's Trace Event format:\n * // JSSTYLED\n *      https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Tracer = void 0;\n\nconst stream_1 = require(\"stream\");\n\nfunction evCommon() {\n  var hrtime = process.hrtime(); // [seconds, nanoseconds]\n\n  var ts = hrtime[0] * 1000000 + Math.round(hrtime[1] / 1000); // microseconds\n\n  return {\n    ts,\n    pid: process.pid,\n    tid: process.pid // no meaningful tid for node.js\n\n  };\n}\n\nclass Tracer extends stream_1.Readable {\n  constructor(opts = {}) {\n    super();\n    this.noStream = false;\n    this.events = [];\n\n    if (typeof opts !== \"object\") {\n      throw new Error(\"Invalid options passed (must be an object)\");\n    }\n\n    if (opts.parent != null && typeof opts.parent !== \"object\") {\n      throw new Error(\"Invalid option (parent) passed (must be an object)\");\n    }\n\n    if (opts.fields != null && typeof opts.fields !== \"object\") {\n      throw new Error(\"Invalid option (fields) passed (must be an object)\");\n    }\n\n    if (opts.objectMode != null && opts.objectMode !== true && opts.objectMode !== false) {\n      throw new Error(\"Invalid option (objectsMode) passed (must be a boolean)\");\n    }\n\n    this.noStream = opts.noStream || false;\n    this.parent = opts.parent;\n\n    if (this.parent) {\n      this.fields = Object.assign({}, opts.parent && opts.parent.fields);\n    } else {\n      this.fields = {};\n    }\n\n    if (opts.fields) {\n      Object.assign(this.fields, opts.fields);\n    }\n\n    if (!this.fields.cat) {\n      // trace-viewer *requires* `cat`, so let's have a fallback.\n      this.fields.cat = \"default\";\n    } else if (Array.isArray(this.fields.cat)) {\n      this.fields.cat = this.fields.cat.join(\",\");\n    }\n\n    if (!this.fields.args) {\n      // trace-viewer *requires* `args`, so let's have a fallback.\n      this.fields.args = {};\n    }\n\n    if (this.parent) {\n      // TODO: Not calling Readable ctor here. Does that cause probs?\n      //      Probably if trying to pipe from the child.\n      //      Might want a serpate TracerChild class for these guys.\n      this._push = this.parent._push.bind(this.parent);\n    } else {\n      this._objectMode = Boolean(opts.objectMode);\n      var streamOpts = {\n        objectMode: this._objectMode\n      };\n\n      if (this._objectMode) {\n        this._push = this.push;\n      } else {\n        this._push = this._pushString;\n        streamOpts.encoding = \"utf8\";\n      }\n\n      stream_1.Readable.call(this, streamOpts);\n    }\n  }\n  /**\n   * If in no streamMode in order to flush out the trace\n   * you need to call flush.\n   */\n\n\n  flush() {\n    if (this.noStream === true) {\n      for (const evt of this.events) {\n        this._push(evt);\n      }\n\n      this._flush();\n    }\n  }\n\n  _read(_) {}\n\n  _pushString(ev) {\n    var separator = \"\";\n\n    if (!this.firstPush) {\n      this.push(\"[\");\n      this.firstPush = true;\n    } else {\n      separator = \",\\n\";\n    }\n\n    this.push(separator + JSON.stringify(ev), \"utf8\");\n  }\n\n  _flush() {\n    if (!this._objectMode) {\n      this.push(\"]\");\n    }\n  }\n\n  child(fields) {\n    return new Tracer({\n      parent: this,\n      fields: fields\n    });\n  }\n\n  begin(fields) {\n    return this.mkEventFunc(\"b\")(fields);\n  }\n\n  end(fields) {\n    return this.mkEventFunc(\"e\")(fields);\n  }\n\n  completeEvent(fields) {\n    return this.mkEventFunc(\"X\")(fields);\n  }\n\n  instantEvent(fields) {\n    return this.mkEventFunc(\"I\")(fields);\n  }\n\n  mkEventFunc(ph) {\n    return fields => {\n      var ev = evCommon(); // Assign the event phase.\n\n      ev.ph = ph;\n\n      if (fields) {\n        if (typeof fields === \"string\") {\n          ev.name = fields;\n        } else {\n          for (const k of Object.keys(fields)) {\n            if (k === \"cat\") {\n              ev.cat = fields.cat.join(\",\");\n            } else {\n              ev[k] = fields[k];\n            }\n          }\n        }\n      }\n\n      if (!this.noStream) {\n        this._push(ev);\n      } else {\n        this.events.push(ev);\n      }\n    };\n  }\n\n}\n\nexports.Tracer = Tracer;\n/*\n * These correspond to the \"Async events\" in the Trace Events doc.\n *\n * Required fields:\n * - name\n * - id\n *\n * Optional fields:\n * - cat (array)\n * - args (object)\n * - TODO: stack fields, other optional fields?\n *\n * Dev Note: We don't explicitly assert that correct fields are\n * used for speed (premature optimization alert!).\n */","map":{"version":3,"sources":["/Users/hamzakhan/Documents/twitter-react/twitter/node_modules/chrome-trace-event/dist/trace-event.js"],"names":["Object","defineProperty","exports","value","Tracer","stream_1","require","evCommon","hrtime","process","ts","Math","round","pid","tid","Readable","constructor","opts","noStream","events","Error","parent","fields","objectMode","assign","cat","Array","isArray","join","args","_push","bind","_objectMode","Boolean","streamOpts","push","_pushString","encoding","call","flush","evt","_flush","_read","_","ev","separator","firstPush","JSON","stringify","child","begin","mkEventFunc","end","completeEvent","instantEvent","ph","name","k","keys"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * trace-event - A library to create a trace of your node app per\n * Google's Trace Event format:\n * // JSSTYLED\n *      https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Tracer = void 0;\nconst stream_1 = require(\"stream\");\nfunction evCommon() {\n    var hrtime = process.hrtime(); // [seconds, nanoseconds]\n    var ts = hrtime[0] * 1000000 + Math.round(hrtime[1] / 1000); // microseconds\n    return {\n        ts,\n        pid: process.pid,\n        tid: process.pid // no meaningful tid for node.js\n    };\n}\nclass Tracer extends stream_1.Readable {\n    constructor(opts = {}) {\n        super();\n        this.noStream = false;\n        this.events = [];\n        if (typeof opts !== \"object\") {\n            throw new Error(\"Invalid options passed (must be an object)\");\n        }\n        if (opts.parent != null && typeof opts.parent !== \"object\") {\n            throw new Error(\"Invalid option (parent) passed (must be an object)\");\n        }\n        if (opts.fields != null && typeof opts.fields !== \"object\") {\n            throw new Error(\"Invalid option (fields) passed (must be an object)\");\n        }\n        if (opts.objectMode != null &&\n            (opts.objectMode !== true && opts.objectMode !== false)) {\n            throw new Error(\"Invalid option (objectsMode) passed (must be a boolean)\");\n        }\n        this.noStream = opts.noStream || false;\n        this.parent = opts.parent;\n        if (this.parent) {\n            this.fields = Object.assign({}, opts.parent && opts.parent.fields);\n        }\n        else {\n            this.fields = {};\n        }\n        if (opts.fields) {\n            Object.assign(this.fields, opts.fields);\n        }\n        if (!this.fields.cat) {\n            // trace-viewer *requires* `cat`, so let's have a fallback.\n            this.fields.cat = \"default\";\n        }\n        else if (Array.isArray(this.fields.cat)) {\n            this.fields.cat = this.fields.cat.join(\",\");\n        }\n        if (!this.fields.args) {\n            // trace-viewer *requires* `args`, so let's have a fallback.\n            this.fields.args = {};\n        }\n        if (this.parent) {\n            // TODO: Not calling Readable ctor here. Does that cause probs?\n            //      Probably if trying to pipe from the child.\n            //      Might want a serpate TracerChild class for these guys.\n            this._push = this.parent._push.bind(this.parent);\n        }\n        else {\n            this._objectMode = Boolean(opts.objectMode);\n            var streamOpts = { objectMode: this._objectMode };\n            if (this._objectMode) {\n                this._push = this.push;\n            }\n            else {\n                this._push = this._pushString;\n                streamOpts.encoding = \"utf8\";\n            }\n            stream_1.Readable.call(this, streamOpts);\n        }\n    }\n    /**\n     * If in no streamMode in order to flush out the trace\n     * you need to call flush.\n     */\n    flush() {\n        if (this.noStream === true) {\n            for (const evt of this.events) {\n                this._push(evt);\n            }\n            this._flush();\n        }\n    }\n    _read(_) { }\n    _pushString(ev) {\n        var separator = \"\";\n        if (!this.firstPush) {\n            this.push(\"[\");\n            this.firstPush = true;\n        }\n        else {\n            separator = \",\\n\";\n        }\n        this.push(separator + JSON.stringify(ev), \"utf8\");\n    }\n    _flush() {\n        if (!this._objectMode) {\n            this.push(\"]\");\n        }\n    }\n    child(fields) {\n        return new Tracer({\n            parent: this,\n            fields: fields\n        });\n    }\n    begin(fields) {\n        return this.mkEventFunc(\"b\")(fields);\n    }\n    end(fields) {\n        return this.mkEventFunc(\"e\")(fields);\n    }\n    completeEvent(fields) {\n        return this.mkEventFunc(\"X\")(fields);\n    }\n    instantEvent(fields) {\n        return this.mkEventFunc(\"I\")(fields);\n    }\n    mkEventFunc(ph) {\n        return (fields) => {\n            var ev = evCommon();\n            // Assign the event phase.\n            ev.ph = ph;\n            if (fields) {\n                if (typeof fields === \"string\") {\n                    ev.name = fields;\n                }\n                else {\n                    for (const k of Object.keys(fields)) {\n                        if (k === \"cat\") {\n                            ev.cat = fields.cat.join(\",\");\n                        }\n                        else {\n                            ev[k] = fields[k];\n                        }\n                    }\n                }\n            }\n            if (!this.noStream) {\n                this._push(ev);\n            }\n            else {\n                this.events.push(ev);\n            }\n        };\n    }\n}\nexports.Tracer = Tracer;\n/*\n * These correspond to the \"Async events\" in the Trace Events doc.\n *\n * Required fields:\n * - name\n * - id\n *\n * Optional fields:\n * - cat (array)\n * - args (object)\n * - TODO: stack fields, other optional fields?\n *\n * Dev Note: We don't explicitly assert that correct fields are\n * used for speed (premature optimization alert!).\n */\n"]},"metadata":{},"sourceType":"script"}